
2025-10-23 21:03:00 - [INFO] --- Stage 1: Collecting Required Deployment Parameters ---
Enter Git Repository URL (e.g., https://github.com/user/repo.git): Enter Git Personal Access Token (PAT - Input hidden): 
Enter Remote Server SSH Username (e.g., ubuntu): Enter Remote Server IP Address: Enter Path to SSH Private Key (e.g., /c/Users/user/.ssh/id_rsa.pem): Enter deployment branch name (Default: main): 
2025-10-23 21:04:12 - [INFO] Using branch: main

2025-10-23 21:04:12 - [INFO] Application Internal Port is fixed at: 8080

2025-10-23 21:04:12 - [INFO] Parameters collected and validated successfully.

2025-10-23 21:04:12 - [INFO] --- Stage 3: Establishing Remote Connection and Checking Access ---
SSH connection successful

2025-10-23 21:04:18 - [INFO] SSH connectivity test passed.

2025-10-23 21:04:18 - [INFO] --- Stage 2: Cloning/Pulling Repository ---

2025-10-23 21:04:18 - [INFO] Cleaning up log files from previous failed runs...

2025-10-23 21:04:18 - [INFO] Cloning repository https://github.com/Hemmie001/automated-deployment_bash-script.git...
Cloning into './cloned_repo'...
Your branch is up to date with 'origin/main'.
Already on 'main'

2025-10-23 21:04:22 - [INFO] Removing local .git directory from cloned repo to prepare for clean transfer...

2025-10-23 21:04:22 - [INFO] Repository synchronized and validated. Code is ready for transfer.

2025-10-23 21:04:22 - [INFO] --- Stage 4: Preparing Remote Host (Installing Dependencies) ---

WARNING: apt does not have a stable CLI interface. Hit:1 http://us-west-2.ec2.archive.ubuntu.com/ubuntu noble InRelease
Get:2 http://us-west-2.ec2.archive.ubuntu.com/ubuntu noble-updates InRelease [126 kB]
Use with caution in scripts.

Get:3 http://us-west-2.ec2.archive.ubuntu.com/ubuntu noble-backports InRelease [126 kB]
Get:4 http://security.ubuntu.com/ubuntu noble-security InRelease [126 kB]
Get:5 http://us-west-2.ec2.archive.ubuntu.com/ubuntu noble-updates/main amd64 Packages [1535 kB]
Get:6 http://us-west-2.ec2.archive.ubuntu.com/ubuntu noble-updates/main amd64 Components [175 kB]
Get:7 http://us-west-2.ec2.archive.ubuntu.com/ubuntu noble-updates/universe amd64 Components [377 kB]
Get:8 http://us-west-2.ec2.archive.ubuntu.com/ubuntu noble-updates/restricted amd64 Components [212 B]
Get:9 http://us-west-2.ec2.archive.ubuntu.com/ubuntu noble-updates/multiverse amd64 Components [940 B]
Get:10 http://us-west-2.ec2.archive.ubuntu.com/ubuntu noble-backports/main amd64 Components [7140 B]
Get:11 http://us-west-2.ec2.archive.ubuntu.com/ubuntu noble-backports/universe amd64 Components [10.9 kB]
Get:12 http://us-west-2.ec2.archive.ubuntu.com/ubuntu noble-backports/restricted amd64 Components [212 B]
Get:13 http://us-west-2.ec2.archive.ubuntu.com/ubuntu noble-backports/multiverse amd64 Components [212 B]
Get:14 http://security.ubuntu.com/ubuntu noble-security/main amd64 Components [21.5 kB]
Get:15 http://security.ubuntu.com/ubuntu noble-security/universe amd64 Components [52.2 kB]
Get:16 http://security.ubuntu.com/ubuntu noble-security/restricted amd64 Components [212 B]
Get:17 http://security.ubuntu.com/ubuntu noble-security/multiverse amd64 Components [208 B]
Fetched 2559 kB in 1s (2416 kB/s)
Reading package lists...
Building dependency tree...
Reading state information...
23 packages can be upgraded. Run 'apt list --upgradable' to see them.

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Reading state information...
docker.io is already the newest version (28.2.2-0ubuntu1~24.04.1).
docker-compose is already the newest version (1.29.2-6ubuntu1).
nginx is already the newest version (1.24.0-2ubuntu7.5).
0 upgraded, 0 newly installed, 0 to remove and 23 not upgraded.
Synchronizing state of nginx.service with SysV service script with /usr/lib/systemd/systemd-sysv-install.
Executing: /usr/lib/systemd/systemd-sysv-install enable nginx
Docker version 28.2.2, build 28.2.2-0ubuntu1~24.04.1
nginx version: nginx/1.24.0 (Ubuntu)

2025-10-23 21:04:49 - [INFO] Remote environment prepared: Docker, Docker Compose, and NGINX are installed and running.

2025-10-23 21:04:49 - [INFO] --- Stage 5: Deploying Application (Transfer and Build) ---

2025-10-23 21:04:49 - [INFO] Transferring project files from local machine to /opt/devops_app...
bash: line 5: log: command not found
devops-container
devops-container
bash: line 10: log: command not found
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            Install the buildx component to build images with BuildKit:
            https://docs.docker.com/go/buildx/

Sending build context to Docker daemon  231.4kB
Step 1/4 : FROM nginx:alpine
 ---> 5e7abcdd2021
Step 2/4 : COPY index.html /usr/share/nginx/html/index.html
 ---> Using cache
 ---> 5b59e45e437d
Step 3/4 : EXPOSE 8080
 ---> Using cache
 ---> eaf476b5d955
Step 4/4 : CMD ["nginx", "-g", "daemon off;"]
 ---> Using cache
 ---> d5b9837992b5
Successfully built d5b9837992b5
Successfully tagged devops-container:latest
780437c862940d6f2554ac17cbb9fb96fbc348eda4c3ce626d193a208f82b748

2025-10-23 21:05:27 - [INFO] Container built and launched successfully on internal port 8080.

2025-10-23 21:05:27 - [INFO] --- Stage 6: Configuring Nginx Reverse Proxy (Port 80 -> Port 8080) ---
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful

2025-10-23 21:05:40 - [INFO] Nginx successfully configured and reloaded.

2025-10-23 21:05:40 - [INFO] --- Stage 7: Final Validation ---
Up Less than a second

2025-10-23 21:05:48 - [FATAL] Validation failed: Nginx proxy check returned non-200 status. Check firewall and container port.
Deployment failed. Check deploy_20251023_210300.log for details.
